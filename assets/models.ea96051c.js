import{d as e,r as t,t as n,a as i,b as r,c as o,e as a,s,f as u,g as l,h as d,i as p,l as m,T as c,p as f,j as h,k as y,m as b,n as v,o as g,q as w,u as N,v as x}from"./ai.156a5c52.js";import{a as k,c as S}from"./lodash.d65d39a6.js";var E={exports:{}};!function(e,t,n){const i={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}};class r{constructor(e,t){this.modelPath=t||`https://storage.googleapis.com/tfjs-models/savedmodel/${this.getPrefix(e)}/model.json`}getPrefix(e){return"lite_mobilenet_v2"===e?`ssd${e}`:`ssd_${e}`}async load(){this.model=await t.loadGraphModel(this.modelPath);const e=n.zeros([1,300,300,3],"int32"),i=await this.model.executeAsync(e);await Promise.all(i.map((e=>e.data()))),i.map((e=>e.dispose())),e.dispose()}async infer(e,t,i){const r=n.tidy((()=>(e instanceof n.Tensor||(e=n.browser.fromPixels(e)),n.expandDims(e)))),o=r.shape[1],a=r.shape[2],s=await this.model.executeAsync(r),u=s[0].dataSync(),l=s[1].dataSync();r.dispose(),n.dispose(s);const[d,p]=this.calculateMaxScores(u,s[0].shape[1],s[0].shape[2]),m=n.getBackend();"webgl"===n.getBackend()&&n.setBackend("cpu");const c=n.tidy((()=>{const e=n.tensor2d(l,[s[1].shape[1],s[1].shape[3]]);return n.image.nonMaxSuppression(e,d,t,i,i)})),f=c.dataSync();return c.dispose(),m!==n.getBackend()&&n.setBackend(m),this.buildDetectedObjects(a,o,l,d,f,p)}buildDetectedObjects(e,t,n,r,o,a){const s=o.length,u=[];for(let l=0;l<s;l++){const s=[];for(let e=0;e<4;e++)s[e]=n[4*o[l]+e];const d=s[0]*t,p=s[1]*e,m=s[2]*t,c=s[3]*e;s[0]=p,s[1]=d,s[2]=c-p,s[3]=m-d,u.push({bbox:s,class:i[a[o[l]]+1].displayName,score:r[o[l]]})}return u}calculateMaxScores(e,t,n){const i=[],r=[];for(let o=0;o<t;o++){let t=Number.MIN_VALUE,a=-1;for(let i=0;i<n;i++)e[o*n+i]>t&&(t=e[o*n+i],a=i);i[o]=t,r[o]=a}return[i,r]}async detect(e,t=20,n=.5){return this.infer(e,t,n)}dispose(){null!=this.model&&this.model.dispose()}}e.ObjectDetection=r,e.load=async function(e={}){if(null==n)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");const t=e.base||"lite_mobilenet_v2",i=e.modelUrl;if(-1===["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(t))throw new Error(`ObjectDetection constructed with invalid base model ${t}. Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.`);const o=new r(t,i);return await o.load(),o},e.version="2.2.2",Object.defineProperty(e,"__esModule",{value:!0})}(E.exports,k(e),t);
/**
    * @license
    * Copyright 2021 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */
var j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function M(e,t){function n(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var O=function(){return(O=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function _(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(a,s)}u((i=i.apply(e,t||[])).next())}))}function q(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var R=function(){function e(e,t){this.model=e,this.outputStride=t;var n=this.model.inputs[0].shape;r(-1===n[1]&&-1===n[2],(function(){return"Input shape ["+n[1]+", "+n[2]+"] must both be equal to or -1"}))}return e.prototype.predict=function(e){var t=this;return n((function(){var n=t.preprocessInput(o(e,"float32")),i=a(n,0),r=t.model.predict(i).map((function(e){return s(e,[0])})),l=t.nameOutputResults(r);return{heatmapScores:u(l.heatmap),offsets:l.offsets,displacementFwd:l.displacementFwd,displacementBwd:l.displacementBwd}}))},e.prototype.dispose=function(){this.model.dispose()},e}(),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t.prototype.preprocessInput=function(e){return n((function(){return l(d(e,127.5),1)}))},t.prototype.nameOutputResults=function(e){return{offsets:e[0],heatmap:e[1],displacementFwd:e[2],displacementBwd:e[3]}},t}(R);function B(e){return Math.floor(e/2)}var P=function(){function e(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return e.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},e.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},e.prototype.empty=function(){return-1===this.numberOfElements},e.prototype.size=function(){return this.numberOfElements+1},e.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},e.prototype.max=function(){return this.priorityQueue[0]},e.prototype.swim=function(e){for(;e>0&&this.less(B(e),e);)this.exchange(e,B(e)),e=B(e)},e.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},e.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},e.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},e.prototype.exchange=function(e,t){var n=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=n},e}();function A(e,t,n,i,r,o){for(var a=o.shape,s=a[0],u=a[1],l=!0,d=Math.max(n-r,0),p=Math.min(n+r+1,s),m=d;m<p;++m){for(var c=Math.max(i-r,0),f=Math.min(i+r+1,u),h=c;h<f;++h)if(o.get(m,h,e)>t){l=!1;break}if(!l)break}return l}var I=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],H=I.length,V=I.reduce((function(e,t,n){return e[t]=n,e}),{});function Q(e,t,n,i){return{y:i.get(e,t,n),x:i.get(e,t,n+H)}}function T(e,t,n){var i=Q(e.heatmapY,e.heatmapX,e.id,n),r=i.y,o=i.x;return{x:e.heatmapX*t+o,y:e.heatmapY*t+r}}function F(e,t,n){return e<t?t:e>n?n:e}function K(e,t){return{x:e.x+t.x,y:e.y+t.y}}[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]].map((function(e){var t=e[0],n=e[1];return[V[t],V[n]]}));var D=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]].map((function(e){var t=e[0],n=e[1];return[V[t],V[n]]})),W=D.map((function(e){return e[1]})),U=D.map((function(e){return e[0]}));function $(e,t,n,i){return{y:F(Math.round(e.y/t),0,n-1),x:F(Math.round(e.x/t),0,i-1)}}function C(e,t,n,i,r,o,a,s){void 0===s&&(s=2);for(var u=i.shape,l=u[0],d=u[1],p=function(e,t,n){var i=n.shape[2]/2;return{y:n.get(t.y,t.x,e),x:n.get(t.y,t.x,i+e)}}(e,$(t.position,o,l,d),a),m=K(t.position,p),c=0;c<s;c++){var f=$(m,o,l,d),h=Q(f.y,f.x,n,r);m=K({x:f.x*o,y:f.y*o},{x:h.x,y:h.y})}var y=$(m,o,l,d),b=i.get(y.y,y.x,n);return{position:m,part:I[n],score:b}}function X(e,t,n,i,r,o){var a=t.shape[2],s=W.length,u=new Array(a),l=e.part,d=e.score,p=T(l,i,n);u[l.id]={score:d,part:I[l.id],position:p};for(var m=s-1;m>=0;--m){var c=W[m],f=U[m];u[c]&&!u[f]&&(u[f]=C(m,u[c],f,t,n,i,o))}for(m=0;m<s;++m)c=U[m],f=W[m],u[c]&&!u[f]&&(u[f]=C(m,u[c],f,t,n,i,r));return u}function Y(e,t,n,i){var r=n.x,o=n.y;return e.some((function(e){var n=e.keypoints[i].position;return function(e,t,n,i){var r=n-e,o=i-t;return r*r+o*o}(o,r,n.y,n.x)<=t}))}function G(e,t,n){return n.reduce((function(n,i,r){var o=i.position,a=i.score;return Y(e,t,o,r)||(n+=a),n}),0)/n.length}function L(e,t,n,i,r,o,a,s){void 0===a&&(a=.5),void 0===s&&(s=20);for(var u=[],l=function(e,t,n){for(var i=n.shape,r=i[0],o=i[1],a=i[2],s=new P(r*o*a,(function(e){return e.score})),u=0;u<r;++u)for(var l=0;l<o;++l)for(var d=0;d<a;++d){var p=n.get(u,l,d);p<e||A(d,p,u,l,t,n)&&s.enqueue({score:p,part:{heatmapY:u,heatmapX:l,id:d}})}return s}(a,1,e),d=s*s;u.length<o&&!l.empty();){var p=l.dequeue();if(!Y(u,d,T(p.part,r,t),p.part.id)){var m=X(p,e,t,r,n,i),c=G(u,d,m);u.push({keypoints:m,score:c})}}return u}function J(e){var t=e.shape,i=t[0],r=t[1],o=t[2];return n((function(){var t=y(e,[i*r,o]),s=b(t,0),u=a(d(s,v(r,"int32")),1),p=a(function(e,t){return n((function(){var n=d(e,v(t,"int32"));return l(e,w(n,v(t,"int32")))}))}(s,r),1);return g([u,p],1)}))}function Z(e,t,n,i){return{y:i.get(e,t,n),x:i.get(e,t,n+H)}}function ee(e,t,r){return n((function(){var n=function(e,t){for(var n=[],i=0;i<H;i++){var r=Z(e.get(i,0).valueOf(),e.get(i,1).valueOf(),i,t),o=r.x,a=r.y;n.push(a),n.push(o)}return x(n,[H,2])}(e,r);return i(o(w(e.toTensor(),v(t,"int32")),"float32"),n)}))}function te(e,t,n){return _(this,void 0,void 0,(function(){var i,r,o,a,s,u,l,d,p,m;return q(this,(function(c){switch(c.label){case 0:return i=0,r=J(e),[4,Promise.all([e.buffer(),t.buffer(),r.buffer()])];case 1:return o=c.sent(),a=o[0],s=o[1],u=o[2],[4,(l=ee(u,n,s)).buffer()];case 2:return d=c.sent(),p=Array.from(function(e,t){for(var n=t.shape[0],i=new Float32Array(n),r=0;r<n;r++){var o=t.get(r,0),a=t.get(r,1);i[r]=e.get(o,a,r)}return i}(a,u)),m=p.map((function(e,t){return i+=e,{position:{y:d.get(t,0),x:d.get(t,1)},part:I[t],score:e}})),r.dispose(),l.dispose(),[2,{keypoints:m,score:i/m.length}]}}))}))}var ne="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",ie="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";var re=[-123.15,-115.9,-103.06],oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t.prototype.preprocessInput=function(e){return i(e,re)},t.prototype.nameOutputResults=function(e){var t=e[0],n=e[1];return{offsets:e[2],heatmap:e[3],displacementFwd:t,displacementBwd:n}},t}(R);function ae(e){return _(this,void 0,void 0,(function(){return q(this,(function(t){return[2,Promise.all(e.map((function(e){return e.buffer()})))]}))}))}function se(e,t){return pe(e,t)?e:Math.floor(e/t)*t+1}function ue(e){r("number"==typeof e||"object"==typeof e,(function(){return"Invalid inputResolution "+e+". Should be a number or an object with width and height"})),"object"==typeof e&&(r("number"==typeof e.width,(function(){return"inputResolution.width has a value of "+e.width+" which is invalid; it must be a number"})),r("number"==typeof e.height,(function(){return"inputResolution.height has a value of "+e.height+" which is invalid; it must be a number"})))}function le(e,t){return ue(e),"object"==typeof e?[se(e.height,t),se(e.width,t)]:[se(e,t),se(e,t)]}var de=[8,16,32];function pe(e,t){return(e-1)%t==0}function me(e){return e instanceof c?[e.shape[0],e.shape[1]]:[e.height,e.width]}function ce(e,t){var i=t[0],r=t[1],o=me(e),a=o[0],s=o[1],u=r/i,l=[0,0,0,0],d=l[0],p=l[1],m=l[2],y=l[3];return s/a<u?(d=0,p=0,m=Math.round(.5*(u*a-s)),y=Math.round(.5*(u*a-s))):(d=Math.round(.5*(1/u*s-a)),p=Math.round(.5*(1/u*s-a)),m=0,y=0),{resized:n((function(){var t=function(e){return e instanceof c?e:N(e)}(e);return t=f(t,[[d,p],[m,y],[0,0]]),h.resizeBilinear(t,[i,r])})),padding:{top:d,left:m,right:y,bottom:p}}}function fe(e,t,n,i,r){var o=t[0],a=t[1],s=n[0],u=n[1],l=function(e,t,n,i,r){return void 0===i&&(i=0),void 0===r&&(r=0),1===n&&1===t&&0===i&&0===r?e:e.map((function(e){return function(e,t,n,i,r){return void 0===i&&(i=0),void 0===r&&(r=0),{score:e.score,keypoints:e.keypoints.map((function(e){var o=e.score,a=e.part,s=e.position;return{score:o,part:a,position:{x:s.x*n+r,y:s.y*t+i}}}))}}(e,t,n,i,r)}))}(e,(o+i.top+i.bottom)/s,(a+i.left+i.right)/u,-i.top,-i.left);return r?function(e,t){return t<=0?e:e.map((function(e){return function(e,t){return{score:e.score,keypoints:e.keypoints.map((function(e){var n=e.score,i=e.part,r=e.position;return{score:n,part:i,position:{x:t-1-r.x,y:r.y}}}))}}(e,t)}))}(l,a):l}var he={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:257},ye=["MobileNetV1","ResNet50"],be={MobileNetV1:[8,16,32],ResNet50:[32,16]},ve={MobileNetV1:[.5,.75,1],ResNet50:[1]},ge=[1,2,4];var we={flipHorizontal:!1},Ne={flipHorizontal:!1,maxDetections:5,scoreThreshold:.5,nmsRadius:20};var xe=function(){function e(e,t){(function(e){r("number"==typeof e,(function(){return"outputStride is not a number"})),r(de.indexOf(e)>=0,(function(){return"outputStride of "+e+" is invalid. It must be either 8, 16, or 32"}))})(e.outputStride),function(e,t){r("number"==typeof e[0]&&"number"==typeof e[1],(function(){return"both resolution values must be a number but had values "+e})),r(pe(e[0],t),(function(){return"height of "+e[0]+" is invalid for output stride "+t+"."})),r(pe(e[1],t),(function(){return"width of "+e[1]+" is invalid for output stride "+t+"."}))}(t,e.outputStride),this.baseModel=e,this.inputResolution=t}return e.prototype.estimateMultiplePoses=function(e,t){return void 0===t&&(t=Ne),_(this,void 0,void 0,(function(){var n,i,r,o,a,s,u,l,d,p,m,c,f,h,y,b,v,g,w,N,x;return q(this,(function(k){switch(k.label){case 0:return n=O({},Ne,t),function(e){var t=e.maxDetections,n=e.scoreThreshold,i=e.nmsRadius;if(t<=0)throw new Error("Invalid maxDetections "+t+". Should be > 0");if(n<0||n>1)throw new Error("Invalid scoreThreshold "+n+". Should be in range [0.0, 1.0]");if(i<=0)throw new Error("Invalid nmsRadius "+i+".")}(t),i=this.baseModel.outputStride,r=this.inputResolution,o=me(e),a=o[0],s=o[1],u=ce(e,r),l=u.resized,d=u.padding,p=this.baseModel.predict(l),m=p.heatmapScores,c=p.offsets,f=p.displacementFwd,h=p.displacementBwd,[4,ae([m,c,f,h])];case 1:return y=k.sent(),b=y[0],v=y[1],g=y[2],w=y[3],[4,L(b,v,g,w,i,n.maxDetections,n.scoreThreshold,n.nmsRadius)];case 2:return N=k.sent(),x=fe(N,[a,s],r,d,n.flipHorizontal),m.dispose(),c.dispose(),f.dispose(),h.dispose(),l.dispose(),[2,x]}}))}))},e.prototype.estimateSinglePose=function(e,t){return void 0===t&&(t=we),_(this,void 0,void 0,(function(){var n,i,r,o,a,s,u,l,d,p,m,c,f,h,y,b;return q(this,(function(v){switch(v.label){case 0:return n=O({},we,t),i=this.baseModel.outputStride,r=this.inputResolution,o=me(e),a=o[0],s=o[1],u=ce(e,r),l=u.resized,d=u.padding,p=this.baseModel.predict(l),m=p.heatmapScores,c=p.offsets,f=p.displacementFwd,h=p.displacementBwd,[4,te(m,c,i)];case 1:return y=v.sent(),b=fe([y],[a,s],r,d,n.flipHorizontal),m.dispose(),c.dispose(),f.dispose(),h.dispose(),l.dispose(),[2,b[0]]}}))}))},e.prototype.estimatePoses=function(e,t){return _(this,void 0,void 0,(function(){return q(this,(function(n){switch(n.label){case 0:return"single-person"!==t.decodingMethod?[3,2]:[4,this.estimateSinglePose(e,t)];case 1:return[2,[n.sent()]];case 2:return[2,this.estimateMultiplePoses(e,t)]}}))}))},e.prototype.dispose=function(){this.baseModel.dispose()},e}();function ke(e){return _(this,void 0,void 0,(function(){var t,n,i,r,o,a,s;return q(this,(function(u){switch(u.label){case 0:if(t=e.outputStride,n=e.quantBytes,i=e.multiplier,null==p)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");return r=function(e,t,n){var i={1:"100",.75:"075",.5:"050"},r="model-stride"+e+".json";return 4===n?ne+"float/"+i[t]+"/"+r:ne+"quant"+n+"/"+i[t]+"/"+r}(t,i,n),[4,m(e.modelUrl||r)];case 1:return o=u.sent(),a=new z(o,t),s=le(e.inputResolution,a.outputStride),[2,new xe(a,s)]}}))}))}function Se(e){return _(this,void 0,void 0,(function(){var t,n,i,r,o,a;return q(this,(function(s){switch(s.label){case 0:if(t=e.outputStride,n=e.quantBytes,null==p)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");return i=function(e,t){var n="model-stride"+e+".json";return 4===t?ie+"float/"+n:ie+"quant"+t+"/"+n}(t,n),[4,m(e.modelUrl||i)];case 1:return r=s.sent(),o=new oe(r,t),a=le(e.inputResolution,o.outputStride),[2,new xe(o,a)]}}))}))}function Ee(e){return void 0===e&&(e=he),_(this,void 0,void 0,(function(){return q(this,(function(t){return"ResNet50"===(e=function(e){if(null==(e=e||he).architecture&&(e.architecture="MobileNetV1"),ye.indexOf(e.architecture)<0)throw new Error("Invalid architecture "+e.architecture+". Should be one of "+ye);if(null==e.inputResolution&&(e.inputResolution=257),ue(e.inputResolution),null==e.outputStride&&(e.outputStride=16),be[e.architecture].indexOf(e.outputStride)<0)throw new Error("Invalid outputStride "+e.outputStride+". Should be one of "+be[e.architecture]+" for architecture "+e.architecture+".");if(null==e.multiplier&&(e.multiplier=1),ve[e.architecture].indexOf(e.multiplier)<0)throw new Error("Invalid multiplier "+e.multiplier+". Should be one of "+ve[e.architecture]+" for architecture "+e.architecture+".");if(null==e.quantBytes&&(e.quantBytes=4),ge.indexOf(e.quantBytes)<0)throw new Error("Invalid quantBytes "+e.quantBytes+". Should be one of "+ge+" for architecture "+e.architecture+".");if("MobileNetV1"===e.architecture&&32===e.outputStride&&1!==e.multiplier)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return e}(e)).architecture?[2,Se(e)]:"MobileNetV1"===e.architecture?[2,ke(e)]:[2,null]}))}))}export{E as c,Ee as l};
